<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,1:ImageSprite;/Areas/Epx/Themes/Msdn/Content:0,/Areas/Epx/Content/Css:1&amp;amp;hashKey=AE9547953540BB1D0978A57B0839847E" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/a23546a2-e0a6-452d-8fc5-71c6ef6c714fCombined.css,1:LinkList,2:ImageSprite,2:SiteFeedbackLink;/Areas/Epx/Themes/Msdn/Content:0,/Areas/Epx/Themes/Base/Content:1,/Areas/Epx/Content/Css:2&amp;amp;hashKey=DB5F5CCF5992DECF048888341DE5A1E1" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Direct3D with XAML Marble Maze</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Direct3D with XAML Marble Maze</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Windows Phone 8
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            XAML, Direct3D
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Phone
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary Language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Last Updated</label>
                    <div id="LastUpdated">5/3/2013</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MS-LPL</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Direct3D-with-XAML-Marble-1d51a37b">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy Code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<div id="mainBody">
<p></p>
<div class="introduction">
<p>This sample app is a port of the Marble Maze Windows Store app. Complete implementation details of the original Marble Maze game can be found in the topic
<a href="http://msdn.microsoft.com/en-us/library/windows/apps/br230257.aspx">Developing Marble Maze</a>. Windows&nbsp;Phone&nbsp;8 supports a subset of the features that are available for Windows Store apps. Because of this, several key changes were made to the app as
 it was ported. Details about these changes are provided later in this document. For more info about creating games for the phone, see
<a href="http://msdn.microsoft.com/library/windowsphone/develop/jj206992(v=vs.105).aspx">
Games for Windows Phone</a>. For more information on creating apps that use both XAML and Direct3D, see
<a href="http://msdn.microsoft.com/library/windowsphone/develop/jj714079(v=vs.105).aspx">
Direct3D with XAML apps for Windows Phone</a>.</p>
<p>This sample uses the <a href="http://msdn.microsoft.com/library/windowsphone/develop/system.windows.controls.drawingsurfacebackgroundgrid(v=vs.105).aspx">
DrawingSurfaceBackgroundGrid</a> control to display Direct3D graphics covering the entire background of the app. This type of app allows you to place other XAML controls on top of background grid. For the pure native Direct3D app version of this sample, see
<a href="http://go.microsoft.com/fwlink/?LinkId=269990">Marble Maze sample for Windows Phone 8</a>.</p>
<p></p>
<p><b>Build the sample</b> </p>
<ol>
<li>
<p>Start Visual Studio Express 2012 for Windows&nbsp;Phone and select <span class="ui">
File</span> &gt; <span class="ui">Open</span> &gt; <span class="ui">Project/Solution</span>.
</p>
</li><li>
<p>Go to the directory in which you unzipped the sample. Double-click the Visual Studio Express 2012 for Windows&nbsp;Phone solution (<span class="label">.sln</span>) file.
</p>
</li><li>
<p>Use <span class="ui">Build</span> &gt; <span class="ui">Rebuild Solution</span> to build the sample.
</p>
</li></ol>
<p></p>
<p><b>Run the sample</b> </p>
<ol>
<li>
<p>To debug the app and then run it, press F5 or use <span class="ui">Debug</span> &gt;
<span class="ui">Start Debugging</span>. To run the app without debugging, press Ctrl&#43;F5 or use
<span class="ui">Debug</span> &gt; <span class="ui">Start Without Debugging</span>.</p>
</li></ol>
<div class="alert">
<table width="100%" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<th align="left"><b>Caution:</b> </th>
</tr>
<tr>
<td>
<p>When running the sample in the debugger and when the debugging mode is set to native, the first time you launch the sample a first-chance exception will be thrown. This is because of the way that Windows Phone Runtime APIs handle the fact that the save game
 file does not exist yet. It is possible to suppress this error, but that could potentially hide other exceptions that may be introduced as you modify the code, so the error is not suppressed in the sample. Click
<span class="ui">Continue</span> in the error dialog to ignore the exception and allow the app to run normally.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p><b>Changes made to the Marble Maze sample to run on Windows Phone</b> </p>
<p>The following list describes the changes that were made to the Marble Maze app when it was ported from a Windows Store app to Windows&nbsp;Phone. Where possible, the source files in the sample solution where the relevant changes were made are listed. For more
 info about what’s different when developing a game for the phone, see <a href="http://msdn.microsoft.com/library/windowsphone/develop/jj662930(v=vs.105).aspx">
Differences in game development between the phone and the desktop</a>.</p>
<ol>
<li>
<p><b>Drawing 2D graphics</b> - Direct2D is not available on Windows&nbsp;Phone. The Windows Store version of the game uses Direct2D to draw 2-D graphics such as GUI elements. The phone version uses helper classes provided by the DirectX Tool Kit (DirectXTK) to
 reimplement the game’s UI. Source files: UserInterface.cpp, LoadScreen.cpp</p>
<p>DirectXTK’s SpriteFont was used in place of Direct2D fonts. Bitmap fonts were precomputed ahead of time. Source files: MarbleMaze.cpp, UserInterface.cpp</p>
</li><li>
<p><b>Loading textures</b> - The Windows Imaging Component (WIC) APIs are not available on Windows&nbsp;Phone. These APIs allow you to load textures in multiple file formats. The phone version of the game uses DDS textures for the load screen instead of PNG images.&nbsp;
 Source files: LoadScreen.cpp</p>
<p>Texture images were downscaled from the versions used on the desktop. This is not for performance reasons but instead to reduce the size of the app. The larger textures greatly increased the app size, but did not provide greater visual fidelity due to the
 phone’s smaller screen. Source files: bridge.dds, bridge_bump.dds, floor_section1.dds, floor_section2.dds, walllevel1.dds</p>
</li><li>
<p><b>Direct3D APIs</b> - Of the Direct3D APIs that are supported on the phone, most function exactly like their desktop counterparts for the supported feature level (feature level 9_3).
</p>
</li><li>
<p><b>File I/O</b> – On Windows&nbsp;Phone, the <span value="LocalSettings"><span class="keyword">LocalSettings</span></span> folder is not supported.&nbsp; The
<span value="PersistentState"><span class="keyword">PersistentState</span></span> class from the desktop version was reimplemented in a custom
<span value="SaveState"><span class="keyword">SaveState</span></span> method. Source files: MarbleMaze.cpp</p>
<p><span value="FileIO"><span class="keyword">FileIO</span> </span>is not available on the phone. The implementation was changed slightly in BasicReaderWriter::ReadDataAsync and BasicReaderWriter::WriteDataAsync. Source files: BasicReaderWriter.cpp</p>
</li><li>
<p><b>Input</b> - To support the phone’s back button, <span value="BackPressed"><span class="keyword">BackPressed</span></span> key handling was added to the game and keyboard events were removed due to the phone’s lack of keyboard support. Source files:
 DirectXApp.cpp, MarbleMaze.cpp</p>
</li><li>
<p><b>Audio</b> - Due to limited support for Microsoft Media Foundation APIs, a custom WAV loading implementation was created. Source files: MediaStreamer.cpp</p>
<p>Code for background music playback was modified to use IMFMediaEngine. Source files: Audio.cpp</p>
</li></ol>
<p><b>See also</b> </p>
<ul>
<li>
<p><a href="http://msdn.microsoft.com/library/windowsphone/develop/jj206992(v=vs.105).aspx">Games for Windows Phone</a>
</p>
</li></ul>
</div>
</div>

</div>


    </div>
</body>
</html>
